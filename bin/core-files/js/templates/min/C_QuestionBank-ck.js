function C_QuestionBank(e){function t(){if(1==transition&&$("#stage").css({opacity:0}),N=checkQuestionComplete(),F=$(data).find("page").eq(currentPage).find("bankitem").length,N&&"edit"!=mode)for(var e=0;e<questionResponse_arr.length;e++)currentPageID==questionResponse_arr[e].id&&(B=questionResponse_arr[e].bankID);else B=randomIntFromRange(0,F-1);W=B,n()}function a(){if(N=checkQuestionComplete(),F=$(data).find("page").eq(currentPage).find("bankitem").length,$(data).find("page").eq(currentPage).attr("tocomplete")&&(K=parseInt($(data).find("page").eq(currentPage).attr("tocomplete"))),"true"==$(data).find("page").eq(currentPage).attr("showall")&&(H=!0,K=F),N&&"edit"!=mode)for(var e=0;e<questionResponse_arr.length;e++)currentPageID==questionResponse_arr[e].id&&(B=questionResponse_arr[e].bankID);else{if(H)for(var t=0;Y.length<F;)Y.push(iterator),iterator++;else for(;Y.length<K;){for(var a=randomIntFromRange(0,F-1),i=!1,e=0;e<Y.length;e++)if(Y[e]==a){i=!0;break}i||Y.push(a)}B=Y[J]}W=B,n()}function n(){x=$(data).find("page").eq(currentPage).find("bankitem").eq(B).attr("attempts"),E=$(data).find("page").eq(currentPage).find("bankitem").eq(B).attr("feedbacktype"),R=$(data).find("page").eq(currentPage).find("bankitem").eq(B).attr("feedbackdisplay"),I=$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("correctresponse").text(),w=$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("incorrectresponse").text(),A=$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("attemptresponse").text(),S=$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("feedback").text(),j=$(data).find("scormVersion").attr("value"),V=$(data).find("page").eq(currentPage).attr("id"),"true"==$(data).find("page").eq(currentPage).find("bankitem").eq(B).attr("randomize")&&(U=!0),pageTitle=new C_PageTitle,$("#stage").append('<div id="scrollableContent" class="antiscroll-wrap top"><div class="box"><div id="contentHolder" class="overthrow antiscroll-inner"><div id="question" class="questionTop"></div><div id="answerOptions"></div></div></div></div>'),audioHolder=new C_AudioHolder,Q=$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("option").length;for(var e=0,t=0;Q>t;t++)"true"==$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("option").eq(t).attr("correct")&&e++;e>1&&(_=!0),k=$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("question").text(),$("#question").append(k);var a=$("#question").text().replace(/\'/g,"").replace(/\"/g,"");$("#question").attr("aria-label",a),pageAccess_arr.push($("#question"));var n=0,i=0;$("#answerOptions").append(0==_?'<div id="answer" class="radioSelector">':'<div id="answer" class="checkBox">');for(var o=[],t=0;Q>t;t++)o.push(t);if(U)var o=shuffleArray(o);for(var s=0;s<o.length;s++){var p=$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("option").eq(o[s]),f="option"+n,l=String.fromCharCode(n%26+65);$("#answer").append(0==_?'<div class="option" id="'+f+'"><input id="'+f+'Check" type="radio" name='+y+'" class="radio" value="'+p.attr("correct")+'"/><label id="label" class="fixFunkyIssue" for="'+f+'Check">'+l+". "+p.find("content").text()+"</label></div>":'<div class="option" id="'+f+'"><input id="'+f+'Check" type="checkbox" name='+y+'" class="radio" value="'+p.attr("correct")+'"/><label id="label" class="fixFunkyIssue" for="'+f+'Check">'+l+". "+p.find("content").text()+"</label></div>"),$(".fixFunkyIssue").click(function(){O=!0}),$("#"+f+"Check").click(function(){O=!0,1==$(this).prop("checked")?$(this).parent().addClass("optionSelected"):$(this).parent().removeClass("optionSelected")}),$("#"+f).click(function(){if($("#mcSubmit").button({disabled:!1}),_)1!=O&&(1==$(this).find("input").prop("checked")?($(this).find("input").prop("checked",!1),$(this).removeClass("optionSelected")):($(this).find("input").prop("checked",!0),$(this).addClass("optionSelected")));else{$(this).find("input").prop("checked",!0);for(var e=0;e<D.length;e++)D[e].hasClass("optionSelected")&&D[e].removeClass("optionSelected");$(this).addClass("optionSelected")}O=!1}).hover(function(){$(this).addClass("optionHover")},function(){$(this).removeClass("optionHover")}),i+=$("#"+f).height()+30,n++,D.push($("#"+f));var u=p;if(_)var a=l+"."+$(u).text().replace(/\'/g,"").replace(/\"/g,"");else var a=l+"."+$(u).text().replace(/\'/g,"").replace(/\"/g,"");$("#"+f+"Check").attr("aria-label",a),pageAccess_arr.push($("#"+f+"Check"))}$("#answerOptions").append('<div id="mcSubmit"></div>'),$("#answerOptions").append("</div>"),$("#mcSubmit").button({label:$(data).find("page").eq(currentPage).find("bankitem").eq(B).attr("btnText"),disabled:!0}),$("#mcSubmit").click(r),$("#mcSubmit").attr("aria-label","Submit your answer.").attr("role","button"),pageAccess_arr.push($("#mcSubmit")),$("#contentHolder").height(stageH-$("#scrollableContent").position().top+audioHolder.getAudioShim()),isIE&&$("#contentHolder").css("margin-bottom","-16px"),"multipleChoiceMedia"==y?($("#answerOptions").addClass("left"),mediaHolder=new C_VisualMediaHolder,mediaHolder.loadVisualMedia(c())):c(),N&&($("#mcSubmit").button({disabled:!0}),d()),1==transition&&TweenMax.to($("#stage"),transitionLength,{css:{opacity:1},ease:transitionType}),doAccess(pageAccess_arr)}function i(){for(var e=0;e<D.length;e++)D[e].unbind()}function d(){for(var e=0;e<questionResponse_arr.length;e++)if(currentPageID==questionResponse_arr[e].id){for(var t=questionResponse_arr[e].userAnswer,a=!0,n=0;n<t.length;n++)D[parseInt(t[n])].find("input").prop("checked","checked"),"false"==D[parseInt(t[n])].find("input").attr("value")?(a=!1,D[t[n]].addClass("optionIncorrect")):D[t[n]].addClass("optionCorrect");if(0==questionResponse_arr[e].correct)for(var d=0;d<D.length;d++)"true"==D[d].find("input").attr("value")&&D[d].addClass("optionCorrect");break}$(".radio").prop("disabled",!0),mandatoryInteraction=!1,i(),checkNavButtons()}function r(){var e=!0;T++;var t=pageTitle.getPageTitle().replace("<![CDATA[","").replace("]]>","").replace(/\s+/g,"");if(0==_){var a=$("#answer input[type='radio']:checked");e="true"==a.val()?!0:!1;var r=$.trim($("label[for='"+a.attr("id")+"']").text().replace(/\s+/g,""));if(r.toLowerCase().indexOf("true")>=0||r.toLowerCase().indexOf("false")>=0){var o="false";r.toLowerCase().indexOf("true")>=0&&(o="true"),setInteractions(V,"true-false",o,e,t+" : "+$.trim($("#question").text()))}else setInteractions(V,"choice",r,e,t+" : "+$.trim($("#question").text()))}else{for(var o=[],c=0;c<D.length;c++)"true"==D[c].find("input").attr("value")?0==D[c].find("input").prop("checked")&&(e=!1):1==D[c].find("input").prop("checked")&&(e=!1),D[c].find("input").prop("checked")&&o.push($.trim($("label[for='"+D[c].find("input").attr("id")+"']").text().replace(/\s+/g,"")));for(var s=!0,p="",c=0;c<o.length;c++)s?(s=!1,p+=o[c]):p+="[,]"+o[c];setInteractions(V,"choice",p,e,t+" : "+$.trim($("#question").text()))}setPageObjective(e,z);var f="";if("undifferentiated"==E)f=1==e?'<div id="dialog-attemptResponse" class="correct" title="'+I+'"><p> '+S+"</p></div>":T==x?'<div id="dialog-attemptResponse" class="incorrect" title="'+w+'"><p> '+S+"</p></div>":'<div id="dialog-attemptResponse" class="incorrect" title="'+w+'"><p>'+A+"</p></div>";else if("differentiated"==E)if(1==e){for(var l="",c=0;c<D.length;c++)1==D[c].find("input").prop("checked")&&(l+="<p><b>You selected</b>: "+$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("option").eq(c).find("content").text()+", ",l+="true"==$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("option").eq(c).attr("correct")?1==_?"that was a correct response.</p>":"that was the correct response.</p>":"that was an incorrect response.</p>",l+="<p>"+$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("option").eq(c).find("diffeed").text()+"</p>");f='<div id="dialog-attemptResponse" class="correct" title="'+I+'"><p> '+l+"</p></div>"}else if(T==x){for(var l="",c=0;c<D.length;c++)1==D[c].find("input").prop("checked")&&(l+="<p><b>You selected</b>: "+$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("option").eq(c).find("content").text()+". ",l+="true"==$(data).find("page").eq(currentPage).find("option").eq(c).attr("correct")?"That was a correct response.</p>":"That was an incorrect response.</p>",l+="<p>"+$(data).find("page").eq(currentPage).find("bankitem").eq(B).find("option").eq(c).find("diffeed").text()+"</p>");f='<div id="dialog-attemptResponse" class="incorrect" title="'+w+'"><p> '+l+"</p></div>"}else f='<div id="dialog-attemptResponse" class="incorrect" title="'+w+'"><p>'+A+"</p></div>";else"standardized"==E&&(f=1==e?'<div id="dialog-attemptResponse" class="correct" title="That is Correct."></div>':T==x?'<div id="dialog-attemptResponse" class="correct" title="That is not correct."></div>':'<div id="dialog-attemptResponse" class="incorrect" title="'+w+'"><p>'+A+"</p></div>");if(1==e||T==x){for(var u=[],c=0;c<D.length;c++)1==D[c].find("input").prop("checked")&&u.push(c);updateScoring(u,e,null,B),$("#mcSubmit").button({disabled:!0}),d()}if($("#stage").append(f),"pop"==R){var g=550;g>windowWidth&&(g=windowWidth-20),1==e||T==x?(J++,$("#dialog-attemptResponse").dialog(J===K?{modal:!0,width:g,dialogClass:"no-close",buttons:{Close:function(){i(),$(this).dialog("close")},Proceed:function(){$(this).dialog("close"),1==isLinear&&updateTracking(),$("#next").click()}},open:function(){$(".ui-dialog-buttonpane").find('button:contains("Close")').addClass("feedback-close-button"),$(".ui-dialog-buttonpane").find('button:contains("Proceed")').addClass("feedback-proceed-button")},close:function(){mandatoryInteraction=!1,checkNavButtons(),$("#dialog-attemptResponse").remove()}}:{modal:!0,width:g,dialogClass:"no-close",buttons:{Next:function(){$(this).dialog("close"),$("#stage").empty(),B=Y[J],n()}},open:function(){$(".ui-dialog-buttonpane").find('button:contains("Next")').addClass("feedback-proceed-button")},close:function(){$("#dialog-attemptResponse").remove()}})):$("#dialog-attemptResponse").dialog({modal:!0,width:g,dialogClass:"no-close",buttons:{OK:function(){$(this).dialog("close"),$("#dialog-attemptResponse").remove()}}})}}function o(){}function c(){$(".antiscroll-wrap").antiscroll(),$("#contentHolder").height(stageH-$("#scrollableContent").position().top+audioHolder.getAudioShim()),"edit"==mode&&($("#question").attr("contenteditable",!0),CKEDITOR.inline("question",{on:{blur:function(e){cachedTextPreEdit!=e.editor.getData()&&b(e.editor.getData()),enableNext(),enableBack()},focus:function(e){cachedTextPreEdit=e.editor.getData(),disableNext(),disableBack()}},toolbar:contentToolbar,toolbarGroups:contentToolgroup,extraPlugins:"sourcedialog"}),$("#answerOptions").prepend("<div id='questionEdit' class='btn_edit_text' title='Edit Question Bank'></div>"),$("#questionEdit").click(function(){s()}).tooltip())}function s(){try{$("#questionEditDialog").remove()}catch(e){}var t="<div id='questionEditDialog' title='Edit Question Bank'>";t+="<label style='position: relative; float: left; margin-right:20px;'><b>Bank Preferences: </b></label>",t+="<label id='label' title='Indicates if this page is graded.'>graded: </label>",t+="<input id='isGraded' type='checkbox' name='graded' class='radio' value='true'/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",t+="<label id='label' title='Indicates if this page is must be completed before going to the next page.'>mandatory: </label>",t+="<input id='isMandatory' type='checkbox' name='mandatory' class='radio' value='true' />",t+="<label id='label' title='Indicates if ALL questions should be presented.'>show all: </label>",t+="<input id='isShowAll' type='checkbox' name='showAll' class='radio' value='true' /><br/>",t+="<div id='questionMenu'><label style='position: relative; float: left; margin-right:20px; vertical-align:middle; line-height:30px;'><b>Questions Menu: </b></label>";for(var a=[],n=0;F>n;n++){var i=n+1,d="bankItem"+n;t+="<div id='"+d+"' class='questionBankItem",t+=W==n?" selectedEditBankMember":" unselectedEditBankMember",t+="' style='",100>n?t+="width:30px;":n>99&&(t+="width:45px;");var r=$(data).find("page").eq(currentPage).find("bankitem").eq(n).find("question").text().replace(/<\/?[^>]+(>|$)/g,"");t+="' data-myID='"+n+"' title='"+r+"'>"+i+"</div>",a.push(d)}t+="</div><br/><br/>";var o=parseInt(W)+1;t+="<div><b>Edit Question #"+o+":</b></div>",t+="<div id='currentEditQuestion' class='editItemContainer'>",t+="<div id='removeBankItem' class='removeMedia' title='Click to remove this bank item'/>",t+="<div><label style='margin-right:20px;'><b>Question Preferences: </b></label>",t+="<label id='label'>no. of attempts: </label>",t+="<input type='text' name='myName' id='inputAttempts' value='"+$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("attempts")+"' class='dialogInput' style='width:35px;' title='Increase the number of attempts.'/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",t+="<label id='label'>randomize options: </label>",t+="<input id='isRandom' type='checkbox' name='random' class='radio' value='true' title='Indicates if the order of the options are randomized on this question.'/><br/>",t+="<div id='label'><b>Input your question: </b></div>",t+="<div id='questionEditText' class='dialogInput' contenteditable='true'></div>",t+="<div id='feedbackTypeGroup'>",t+="<label id='label' style='margin-right:20px;'><b>Question Feedback Type: </b></label>",t+="<input id='undifferentiated' type='radio' name='manageFeedbackType' value='undifferentiated' title='One user defined feedback is used.'>undifferentiated</input>",t+="<input id='differentiated' type='radio' name='manageFeedbackType' value='differentiated' title='User defined feedback is used for each option.'>differentiated</input>",t+="</div></div>","undifferentiated"==$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("feedbacktype")&&(t+="<div id='feedbackLabel'><b>Input your feedback:</b></div>",t+="<div id='feedbackEditText' type='text' contenteditable='true' class='dialogInput'>"+$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("feedback").text()+"</div>"),t+="<br/></div></div>",$("#stage").append(t),$("#questionEditText").append($(data).find("page").eq(currentPage).find("bankitem").eq(W).find("question").text()),$("#removeBankItem").click(l).tooltip(),CKEDITOR.inline("questionEditText",{toolbar:contentToolbar,toolbarGroups:contentToolgroup,enterMode:CKEDITOR.ENTER_BR,shiftEnterMode:CKEDITOR.ENTER_P,extraPlugins:"sourcedialog",on:{instanceReady:function(e){$(e.editor.element.$).attr("title","Click here to edit this question.")}}});for(var c=0;c<a.length;c++)if(W!=c){var d="#"+a[c];$(d).click(function(){var e=p();m(e),$("#bankItem"+W).removeClass("selectedEditBankMember").addClass("unselectedEditBankMember"),W=$(this).attr("data-myID"),$(this).removeClass("unselectedEditBankMember").addClass("selectedEditBankMember"),$("#questionEditDialog").remove(),G=[],s()}).tooltip()}"false"==$(data).find("page").eq(currentPage).attr("graded")?$("#isGraded").removeAttr("checked"):$("#isGraded").attr("checked","checked"),"false"==$(data).find("page").eq(currentPage).attr("mandatory")?$("#isMandatory").removeAttr("checked"):$("#isMandatory").attr("checked","checked"),"false"==$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("randomize")?$("#isRandom").removeAttr("checked"):$("#isRandom").attr("checked","checked"),"undifferentiated"==$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("feedbacktype")&&CKEDITOR.inline("feedbackEditText",{toolbar:contentToolbar,toolbarGroups:contentToolgroup,enterMode:CKEDITOR.ENTER_BR,shiftEnterMode:CKEDITOR.ENTER_P,extraPlugins:"sourcedialog",on:{instanceReady:function(e){$(e.editor.element.$).attr("title","Click here to edit this feedback.")}}}),$("#"+$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("feedbacktype")).prop("checked",!0),$("#feedbackTypeGroup").change(function(){var e=p(!0);m(e),$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("feedbacktype",$("input[name=manageFeedbackType]:checked","#feedbackTypeGroup").val()),$("#questionEditDialog").remove(),G=[],s()});for(var f=0;f<$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").length;f++)g(f,!1);$("#questionEditDialog").dialog({autoOpen:!0,modal:!0,width:800,height:650,dialogClass:"no-close",buttons:{AddQuestion:function(){var e=p();m(e),u(F)},AddOption:function(){g(G.length,!0)},Done:function(){var e=p();q(e),$("#questionEditDialog").dialog("close")}},close:function(){$("#questionEditDialog").remove()}}),$("button").eq(3).attr("title","Adds a new question."),$("button").eq(4).attr("title","Adds a new matching option."),$("button").eq(5).attr("title","Closes the edit dialog."),$(function(){$(document).tooltip()})}function p(e){var t=new Object;t.attempts=$("#inputAttempts").val(),1==$("#isGraded").prop("checked")?($(data).find("page").eq(currentPage).attr("graded","true"),t.graded=!0):($(data).find("page").eq(currentPage).attr("graded","false"),t.graded=!1),1==$("#isMandatory").prop("checked")?($(data).find("page").eq(currentPage).attr("mandatory","true"),t.mandatory=!0):($(data).find("page").eq(currentPage).attr("mandatory","false"),t.mandatory=!1),1==$("#isRandom").prop("checked")?$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("randomize","true"):$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("randomize","false"),t.question=CKEDITOR.instances.questionEditText.getData();try{CKEDITOR.instances.questionEditText.destroy()}catch(a){}if(t.feedbackType=$("input[name=manageFeedbackType]:checked","#feedbackTypeGroup").val(),t.feedbackTypeChange=1==e?!0:!1,"undifferentiated"==$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("feedbacktype")){t.feedbackUpdate=CKEDITOR.instances.feedbackEditText.getData();try{CKEDITOR.instances.feedbackEditText.destroy()}catch(a){}}for(var n=new Array,i=0;i<G.length;i++){var d=new Object;d.optionText=CKEDITOR.instances[G[i]+"Text"].getData();try{CKEDITOR.instances[G[i]+"Text"].destroy()}catch(a){}if(d.optionCorrect=$("#"+G[i]+"Correct").prop("checked"),"differentiated"==$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("feedbacktype")){d.difText=CKEDITOR.instances[G[i]+"DifFeedText"].getData();try{CKEDITOR.instances[G[i]+"DifFeedText"].destroy()}catch(a){}}n.push(d)}return t.option_arr=n,t}function f(e){for(var t=0;t<G.length;t++)if(e==$("#"+G[t]+"Container").attr("value")){var a=t;break}$(data).find("pages").eq(currentPage).find("bankitem").eq(W).find("option").eq(a).remove(),G.splice(a,1),$("#option"+e+"Container").remove()}function l(){F>1?($(data).find("pages").eq(currentPage).find("bankitem").eq(W).remove(),F--,$("#questionEditDialog").remove(),G=[],W=0,s()):alert("you must have at least one bank item.")}function u(e){$(data).find("page").eq(currentPage).append($("<bankitem>"));var t=(new DOMParser).parseFromString("<bankitem></bankitem>","text/xml");$(data).find("page").eq(currentPage).find("bankitem").eq(e).append($("<question>"));var a=(new DOMParser).parseFromString("<question></question>","text/xml"),n=a.createCDATASection("<p>Input your question.</p>");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("question").append(n),$(data).find("page").eq(currentPage).find("bankitem").eq(e).append($("<option>"));var i=(new DOMParser).parseFromString("<option></option>","text/xml");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(0).append($("<content>"));var d=(new DOMParser).parseFromString("<content></content>","text/xml"),r=d.createCDATASection("True");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(0).find("content").append(r),$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(0).append($("<diffeed>"));var o=(new DOMParser).parseFromString("<diffeed></diffeed>","text/xml"),c=o.createCDATASection("Input unique option feedback.");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(0).find("diffeed").append(c),$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(0).attr("correct","true"),$(data).find("page").eq(currentPage).find("bankitem").eq(e).append($("<option>"));var p=(new DOMParser).parseFromString("<option></option>","text/xml");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(1).append($("<content>"));var f=(new DOMParser).parseFromString("<content></content>","text/xml"),l=f.createCDATASection("False");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(1).find("content").append(l),$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(1).append($("<diffeed>"));var u=(new DOMParser).parseFromString("<diffeed></diffeed>","text/xml"),g=o.createCDATASection("Input unique option feedback.");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(1).find("diffeed").append(g),$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("option").eq(1).attr("correct","false"),$(data).find("page").eq(currentPage).find("bankitem").eq(e).append($("<attemptresponse>"));var b=(new DOMParser).parseFromString("<attemptresponse></attemptresponse>","text/xml"),m=b.createCDATASection("That is not correct.  Please try again.");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("attemptresponse").append(m),$(data).find("page").eq(currentPage).find("bankitem").eq(e).append($("<correctresponse>"));var q=(new DOMParser).parseFromString("<correctresponse></correctresponse>","text/xml"),k=q.createCDATASection("That is correct!");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("correctresponse").append(k),$(data).find("page").eq(currentPage).find("bankitem").eq(e).append($("<incorrectresponse>"));var v=(new DOMParser).parseFromString("<incorrectresponse></incorrectresponse>","text/xml"),h=v.createCDATASection("That is not correct.");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("incorrectresponse").append(h),$(data).find("page").eq(currentPage).find("bankitem").eq(e).append($("<feedback>"));var P=(new DOMParser).parseFromString("<feedback></feedback>","text/xml"),x=P.createCDATASection("Input your feedback here.");$(data).find("page").eq(currentPage).find("bankitem").eq(e).find("feedback").append(x),$(data).find("page").eq(currentPage).find("bankitem").eq(e).attr("feedbacktype","undifferentiated"),$(data).find("page").eq(currentPage).find("bankitem").eq(e).attr("feedbackdisplay","pop"),$(data).find("page").eq(currentPage).find("bankitem").eq(e).attr("audio","null"),$(data).find("page").eq(currentPage).find("bankitem").eq(e).attr("btnText","Submit"),$(data).find("page").eq(currentPage).find("bankitem").eq(e).attr("attempts",2),$(data).find("page").eq(currentPage).find("bankitem").eq(e).attr("randomize",!1),F++,W=e,$("#questionEditDialog").remove(),G=[],s()}function g(e,t){var a="option"+e,n=e+1;if(1==t){$(data).find("page").eq(currentPage).find("bankitem").eq(W).append($("<option>"));var i=(new DOMParser).parseFromString("<option></option>","text/xml");$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(e).append($("<content>"));var d=(new DOMParser).parseFromString("<content></content>","text/xml"),r=d.createCDATASection("True");$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(e).find("content").append(r),$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(e).append($("<diffeed>"));var o=(new DOMParser).parseFromString("<diffeed></diffeed>","text/xml"),c=o.createCDATASection("Input unique option feedback.");$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(e).find("diffeed").append(c),$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(e).attr("correct","false")}var s=$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(e).find("content").text(),p="<div id='"+a+"Container' class='templateAddItem' value='"+e+"'>";if(p+="<div id='"+a+"Remove' class='removeMedia' value='"+e+"' title='Click to remove this answer option'/>",p+="<div id='"+a+"Input' style='padding-bottom:5px;'><b>Option "+n+":</b></div>",p+="<div id='"+a+"Text' contenteditable='true' class='dialogInput'>"+s+"</div>",p+="<label id='label'><b>correct:</b></label>",p+="true"==$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(e).attr("correct")?"<input id='"+a+"Correct' type='checkbox' checked='checked' name='correct' class='radio' value='true' title='Indicates if the option is a correct answer.'/>":"<input id='"+a+"Correct' type='checkbox' name='correct' class='radio' value='true' title='Indicates if the option is a correct answer.'/>","differentiated"==$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("feedbacktype")){p+="<br/>";var l=$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(e).find("diffeed").text();p+="<label id='label'><b>Option "+n+" Differentiated Feedback:</b></label>",p+="<div id='"+a+"DifFeedText' contenteditable='true' class='dialogInput'>"+l+"</div>"}p+="</div>",$("#currentEditQuestion").append(p),$("#"+a+"Remove").on("click",function(){f($(this).attr("value"))}),CKEDITOR.inline(a+"Text",{toolbar:contentToolbar,toolbarGroups:contentToolgroup,enterMode:CKEDITOR.ENTER_BR,shiftEnterMode:CKEDITOR.ENTER_P,extraPlugins:"sourcedialog",on:{instanceReady:function(e){$(e.editor.element.$).attr("title","Click here to edit this option text.")}}}),"differentiated"==$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("feedbacktype")&&CKEDITOR.inline(a+"DifFeedText",{toolbar:contentToolbar,toolbarGroups:contentToolgroup,enterMode:CKEDITOR.ENTER_BR,shiftEnterMode:CKEDITOR.ENTER_P,extraPlugins:"sourcedialog",on:{instanceReady:function(e){$(e.editor.element.$).attr("title","Click here to edit this feedback.")}}}),G.push(a)}function b(e){var t=(new DOMParser).parseFromString("<question></question>","application/xml"),a=t.createCDATASection(e);$(data).find("page").eq(currentPage).find("bankitem").find("question").first().empty(),$(data).find("page").eq(currentPage).find("bankitem").find("question").first().append(a),sendUpdateWithRefresh()}function m(e){var t=e.question,a=(new DOMParser).parseFromString("<question></question>","application/xml"),n=a.createCDATASection(t);if($(data).find("page").eq(currentPage).find("bankitem").eq(W).find("question").empty(),$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("question").append(n),e.feedbackUpdate){var i=e.feedbackUpdate,d=(new DOMParser).parseFromString("<feedback></feedback>","application/xml"),r=d.createCDATASection(i);$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("feedback").empty(),$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("feedback").append(r)}$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("attempts",e.attempts);for(var o=0;o<questionResponse_arr.length;o++)questionResponse_arr[o].id==$(data).find("page").eq(currentPage).attr("id")&&(questionResponse_arr[o].graded=e.graded);$(data).find("page").eq(currentPage).attr("graded",e.graded),$(data).find("page").eq(currentPage).attr("mandatory",e.mandatory),$(data).find("page").eq(currentPage).find("bankitem").eq(W).attr("feedbacktype",e.feedbackType);for(var c=0;c<G.length;c++){var s=0,p=e.option_arr[c].optionText,f=e.option_arr[c].optionCorrect,l=(new DOMParser).parseFromString("<option></option>","text/xml"),u=l.createCDATASection(p);if($(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(c).find("content").empty(),$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(c).find("content").append(u),e.option_arr[c].difText){var g=e.option_arr[c].difText,b=l.createCDATASection(g);$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(c).find("diffeed").empty(),$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(c).find("diffeed").append(b)}$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(c).attr("correct",f)}for(var m=$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").length,q=G.length,k=m-q,c=m+1;c>=q;c--)$(data).find("page").eq(currentPage).find("bankitem").eq(W).find("option").eq(c).remove()}function q(e){m(e);for(var t=$(data).find("page").eq(currentPage).find("bankitem").length,a=F,n=t-a,i=t+1;i>=a;i--)$(data).find("page").eq(currentPage).find("bankitem").eq(i).remove();sendUpdateWithRefresh(),fadeComplete()}var k,v=0,h=0,P=0,x=2,T=0,C="a",y=e,D=[],E,R,I,w,A,S,O=!1,M,_=!1,F=0,B=0,K=1,H=!1,N=!1,G=[],Q=0,z=!1,L=!0,U=!1,W=0,j,V,Y=[],J=0,X=[];this.initialize=function(){pageAccess_arr=[],audioAccess_arr=[],1==transition&&$("#stage").css({opacity:0}),"true"==$(data).find("page").eq(currentPage).attr("graded")&&(z=!0),"false"==$(data).find("page").eq(currentPage).attr("mandatory")&&(L=!1),a()},this.destroySelf=function(){TweenMax.to($("#stage"),transitionLength,{css:{opacity:0},ease:Power2.easeIn,onComplete:fadeComplete})},this.fadeComplete=function(){fadeComplete()}}